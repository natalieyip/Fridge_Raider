<h1> Hello, what would you like to make today? </h1>
<form id="recipe-form" action="recipes/index" method="get"> 
	<input type="text" name="ingredients"> 
	<input type="submit" value="Create">
</form>

<%= javascript_tag do %>
	$("#recipe-form").on("submit", function(e) {
		e.preventDefault();

		var form = this;
		var food = $(form).children()[0].value;

		var apiID = '<%= ENV["EDAMAM_API_ID"] %>';
		var apiKey = '<%= ENV["EDAMAM_API_KEY"] %>';
		var unencodedURL = `https://api.edamam.com/search?q=${food}&app_id=${apiID}&app_key=${apiKey}`;
		var url = encodeURI(unencodedURL);
		
		$.ajax({
			url: url
		})
		.done(function(response) {
			console.log(JSON.stringify(response));

			for (var i = 0; i <= 10; i ++){
				var link = response['hits'][i]['recipe']['url']
				if(link.endsWith("/")){ 
					link = link.slice(0, -1)
				}
				$('body').append(`<ol> <a href=${link}>` + response['hits'][i]['recipe']['label']+ `</a></ol>`) 
				
			}
		})
		.fail(function(response) {
			console.log("fail");
		});
	});
<% end %>

<body> 
</body>